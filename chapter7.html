<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no, viewport-fit=cover">
    <meta charset="UTF-8">
    <title data-translate="chapter7"></title>
    <link rel="stylesheet" href="styles.css">
    <script>
        function setViewportHeight() {
            let vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
        }
        window.addEventListener('resize', setViewportHeight);
        window.addEventListener('orientationchange', setViewportHeight);
        setViewportHeight();

        function detectMobile() {
            const userAgent = navigator.userAgent || navigator.vendor || window.opera;
            const isMobile = /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(userAgent.toLowerCase());
            if (isMobile) {
                document.body.classList.add('is-mobile');
            }
        }
        window.addEventListener('load', detectMobile);
        detectMobile();

        function preloadImages() {
            const starImages = [
                ['gold0_silver0.png', 'gold0_silver1.png', 'gold0_silver2.png', 'gold0_silver3.png', 'gold0_silver4.png', 'gold0_silver5.png', 'gold0_silver6.png'],
                ['gold1_silver0.png', 'gold1_silver1.png', 'gold1_silver2.png', 'gold1_silver3.png', 'gold1_silver4.png', 'gold1_silver5.png'],
                ['gold2_silver0.png', 'gold2_silver1.png', 'gold2_silver2.png', 'gold2_silver3.png', 'gold2_silver4.png'],
                ['gold3_silver0.png', 'gold3_silver1.png', 'gold3_silver2.png', 'gold3_silver3.png'],
                ['gold4_silver0.png', 'gold4_silver1.png', 'gold4_silver2.png'],
                ['gold5_silver0.png', 'gold5_silver1.png'],
                ['gold6_silver0.png']
            ];
            console.log('Preloading star images for chapter');
            starImages.forEach((goldLevelImages) => {
                goldLevelImages.forEach((image) => {
                    const img = new Image();
                    img.src = image;
                    img.onload = () => console.log(`Loaded image: ${image}`);
                    img.onerror = () => console.error(`Failed to preload image: ${image}`);
                });
            });
        }
        preloadImages();
    </script>
</head>
<body class="chapters">
    <div class="piano-menu" id="menuButton" aria-expanded="false" aria-controls="menu-placeholder">
        <div class="white-key"></div>
        <div class="white-key"></div>
        <div class="white-key"></div>
        <div class="black-key top"></div>
        <div class="black-key bottom"></div>
    </div>
    <nav id="menu-placeholder"></nav>
    <h1 class="chapter-title">
        <span class="chapter-number"></span>
        <span class="chapter-name"></span>
    </h1>
    <div class="chapter-container" id="chapterContainer">
        <div class="stars-svg" id="stars-4x4">
            <svg
                width="650"
                height="700"
                viewBox="0 0 650 700"
                version="1.1"
                id="svg1"
                xml:space="preserve"
                xmlns="http://www.w3.org/2000/svg"
                xmlns:svg="http://www.w3.org/2000/svg">
                <defs id="defs1" />
                <g inkscape:label="Stars" inkscape:groupmode="layer" id="layer1" style="fill:#999999;fill-opacity:1">
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-1-1" x="0" y="0" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-1-2" x="170" y="0" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-1-3" x="340" y="0" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-1-4" x="510" y="0" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-2-1" x="0" y="180" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-2-2" x="170" y="180" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-2-3" x="340" y="180" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-2-4" x="510" y="180" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-3-1" x="0" y="360" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-3-2" x="170" y="360" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-3-3" x="340" y="360" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-3-4" x="510" y="360" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-4-1" x="0" y="540" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-4-2" x="170" y="540" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-4-3" x="340" y="540" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-4-4" x="510" y="540" />
                </g>
                <g inkscape:groupmode="layer" id="layer3" inkscape:label="Codes">
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="70" y="139.20798" id="code-1-1-1"><tspan sodipodi:role="line" x="70" y="139.20798">1:1:1</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="240" y="139.20798" id="code-1-1-2"><tspan sodipodi:role="line" x="240" y="139.20798">1:1:2</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="410" y="139.20798" id="code-1-1-3"><tspan sodipodi:role="line" x="410" y="139.20798">1:1:3</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="580" y="139.20798" id="code-1-1-4"><tspan sodipodi:role="line" x="580" y="139.20798">1:1:4</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="70" y="319.20798" id="code-1-2-1"><tspan sodipodi:role="line" x="70" y="319.20798">1:2:1</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="240" y="319.20798" id="code-1-2-2"><tspan sodipodi:role="line" x="240" y="319.20798">1:2:2</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="410" y="319.20798" id="code-1-2-3"><tspan sodipodi:role="line" x="410" y="319.20798">1:2:3</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="580" y="319.20798" id="code-1-2-4"><tspan sodipodi:role="line" x="580" y="319.20798">1:2:4</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="70" y="499.20798" id="code-1-3-1"><tspan sodipodi:role="line" x="70" y="499.20798">1:3:1</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="240" y="499.20798" id="code-1-3-2"><tspan sodipodi:role="line" x="240" y="499.20798">1:3:2</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="410" y="499.20798" id="code-1-3-3"><tspan sodipodi:role="line" x="410" y="499.20798">1:3:3</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="580" y="499.20798" id="code-1-3-4"><tspan sodipodi:role="line" x="580" y="499.20798">1:3:4</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="70" y="679.20801" id="code-1-4-1"><tspan sodipodi:role="line" x="70" y="679.20801">1:4:1</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="240" y="679.20801" id="code-1-4-2"><tspan sodipodi:role="line" x="240" y="679.20801">1:4:2</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="410" y="679.20801" id="code-1-4-3"><tspan sodipodi:role="line" x="410" y="679.20801">1:4:3</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="580" y="679.20801" id="code-1-4-4"><tspan sodipodi:role="line" x="580" y="679.20801">1:4:4</tspan></text>
                </g>
            </svg>
        </div>
        <div class="stars-svg" id="stars-2x2x4" style="display: none;">
            <svg width="310" height="1650" viewBox="0 0 310 1650" version="1.1" id="svg2" xmlns="http://www.w3.org/2000/svg">
                <defs id="defs2" />
                <g inkscape:label="Stars" inkscape:groupmode="layer" id="layer1-2" style="fill:#999999;fill-opacity:1">
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-1-1" x="0" y="0" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-1-2" x="170" y="0" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-1-3" x="0" y="180" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-1-4" x="170" y="180" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-2-1" x="0" y="410" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-2-2" x="170" y="410" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-2-3" x="0" y="590" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-2-4" x="170" y="590" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-3-1" x="0" y="820" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-3-2" x="170" y="820" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-3-3" x="0" y="1000" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-3-4" x="170" y="1000" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-4-1" x="0" y="1230" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-4-2" x="170" y="1230" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-4-3" x="0" y="1410" />
                    <image width="140" height="119.26923" preserveAspectRatio="none" xlink:href="gold0_silver0.png" id="star-1-4-4" x="170" y="1410" />
                </g>
                <g inkscape:groupmode="layer" id="layer3-2" inkscape:label="Codes">
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="70" y="143.20798" id="code-1-1-1"><tspan sodipodi:role="line" x="70" y="143.20798">1:1:1</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="240" y="143.20798" id="code-1-1-2"><tspan sodipodi:role="line" x="240" y="143.20798">1:1:2</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="70" y="323.20798" id="code-1-1-3"><tspan sodipodi:role="line" x="70" y="323.20798">1:1:3</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="240" y="323.20798" id="code-1-1-4"><tspan sodipodi:role="line" x="240" y="323.20798">1:1:4</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="70" y="553.20798" id="code-1-2-1"><tspan sodipodi:role="line" x="70" y="553.20798">1:2:1</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="240" y="553.20798" id="code-1-2-2"><tspan sodipodi:role="line" x="240" y="553.20798">1:2:2</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="70" y="733.20798" id="code-1-2-3"><tspan sodipodi:role="line" x="70" y="733.20798">1:2:3</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="240" y="733.20798" id="code-1-2-4"><tspan sodipodi:role="line" x="240" y="733.20798">1:2:4</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="70" y="963.20798" id="code-1-3-1"><tspan sodipodi:role="line" x="70" y="963.20798">1:3:1</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="240" y="963.20798" id="code-1-3-2"><tspan sodipodi:role="line" x="240" y="963.20798">1:3:2</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="70" y="1143.20798" id="code-1-3-3"><tspan sodipodi:role="line" x="70" y="1143.20798">1:3:3</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="240" y="1143.20798" id="code-1-3-4"><tspan sodipodi:role="line" x="240" y="1143.20798">1:3:4</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="70" y="1373.20801" id="code-1-4-1"><tspan sodipodi:role="line" x="70" y="1373.20801">1:4:1</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="240" y="1373.20801" id="code-1-4-2"><tspan sodipodi:role="line" x="240" y="1373.20801">1:4:2</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="70" y="1553.20801" id="code-1-4-3"><tspan sodipodi:role="line" x="70" y="1553.20801">1:4:3</tspan></text>
                    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:21.3333px;font-family:Cochin;-inkscape-font-specification:'Cochin, Medium';text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#999999;stroke:none;fill-opacity:1" x="240" y="1553.20801" id="code-1-4-4"><tspan sodipodi:role="line" x="240" y="1553.20801">1:4:4</tspan></text>
                </g>
                <g inkscape:groupmode="layer" id="layer4" inkscape:label="Separators">
                    <line x1="74" y1="370" x2="230" y2="370" style="stroke:#444444;stroke-width:1" />
                    <line x1="74" y1="780" x2="230" y2="780" style="stroke:#444444;stroke-width:1" />
                    <line x1="74" y1="1190" x2="230" y2="1190" style="stroke:#444444;stroke-width:1" />
                </g>
            </svg>
        </div>
    </div>
    <div id="namePopup" class="popup" style="display: none;">
        <div class="popup-content">
            <div class="popup-scrollable-content">
                <h2 id="popupWelcome"></h2>
                <p id="popupIntro"></p>
                <div class="rank-badge-container">
                    <img src="rank-start.png" alt="Explorer Rank Badge" class="rank-badge-image">
                </div>
                <p id="popupTeacherNote"></p>
                <p id="popupEnterName"></p>
            </div>
            <div class="input-group">
                <input type="text" id="nameInput">
                <button id="submitNameButton" onclick="saveName()"></button>
            </div>
        </div>
    </div>
    <div id="studentPopup" class="student-popup">
        <div class="student-popup-content">
            <p id="studentPopupMessage"></p>
        </div>
    </div>
    <div id="rankAchievementPopup" class="popup" style="display: none;">
        <div class="popup-content" onclick="event.stopPropagation();">
            <div class="popup-scrollable-content">
                <h2 id="rankAchievementMessage"></h2>
                <h3 id="rankAchievementSubtitle"></h3>
                <div class="rank-badge-container">
                    <img src="rank0.png" alt="Star Cadet Rank Badge" class="rank-badge-image" onerror="this.src='rank-start.png';">
                </div>
                <p id="rankAchievementDescription"></p>
            </div>
            <button id="closeRankPopup" class="close-button">×</button>
        </div>
    </div>
    <div id="consentPopup" style="display: none;">
        <div class="consent-popup-content">
            <p id="consentMessage"></p>
            <div class="consent-buttons">
                <button id="consentAcceptButton"></button>
                <button id="consentRejectButton"></button>
                <button id="consentPolicyLink" data-translate="consentPolicyLink"></button>
            </div>
        </div>
    </div>
    <div class="user-name-display">
        <span id="userNameDisplay"></span>
    </div>
    <script src="students.js"></script>
    <script src="chapter.js"></script>
    <script src="script.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        document.body.style.touchAction = 'manipulation';
        const nameInput = document.getElementById('nameInput');
        if (nameInput) {
            let originalScrollY = 0;
            let isKeyboardOpen = false;

            const lockViewport = () => {
                if (!isKeyboardOpen) {
                    originalScrollY = window.scrollY;
                    document.body.style.position = 'fixed';
                    document.body.style.top = `-${originalScrollY}px`;
                    document.body.style.width = '100%';
                    document.body.style.overflow = 'hidden';
                    isKeyboardOpen = true;
                }
            };

            const unlockViewport = () => {
                if (isKeyboardOpen) {
                    document.body.style.position = '';
                    document.body.style.top = '';
                    document.body.style.width = '';
                    document.body.style.overflow = '';
                    // Only scroll if keyboard was actually open
                    window.scrollTo(0, originalScrollY);
                    isKeyboardOpen = false;
                }
            };

            nameInput.addEventListener('focus', () => {
                document.body.classList.add('keyboard-open');
                lockViewport();
            });

            nameInput.addEventListener('blur', () => {
                document.body.classList.remove('keyboard-open');
                unlockViewport();
            });

            window.addEventListener('resize', () => {
                const viewportHeight = window.innerHeight;
                const isKeyboardLikelyOpen = viewportHeight < 500; // Adjust threshold based on device
                if (isKeyboardLikelyOpen && !isKeyboardOpen) {
                    lockViewport();
                } else if (!isKeyboardLikelyOpen && isKeyboardOpen) {
                    unlockViewport();
                }
            });
        }
        if (typeof initializeConsentPopup === 'function') {
            initializeConsentPopup();
        }
    });
</script>
</body>
</html>